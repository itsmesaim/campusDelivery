<div class="vendor-analytics-page">
    <div class="page-header">
        <h1>Business Analytics</h1>
        <p>Track your performance and insights</p>
        <a href="/dashboard/vendor" class="back-btn">‚Üê Back to Dashboard</a>
    </div>

    <!-- Key Metrics -->
    <div class="metrics-grid">
        <div class="metric-card revenue">
            <div class="metric-icon">üí∞</div>
            <div class="metric-content">
                <h3>‚Çπ{{analytics.totalRevenue}}</h3>
                <p>Total Revenue</p>
                <span class="metric-change positive">+12% from last month</span>
            </div>
        </div>
        <div class="metric-card orders">
            <div class="metric-icon">üì¶</div>
            <div class="metric-content">
                <h3>{{analytics.totalOrders}}</h3>
                <p>Total Orders</p>
                <span class="metric-change positive">+8% from last month</span>
            </div>
        </div>
        <div class="metric-card rating">
            <div class="metric-icon">‚≠ê</div>
            <div class="metric-content">
                <h3>{{analytics.averageRating}}</h3>
                <p>Average Rating</p>
                <span class="metric-change neutral">Same as last month</span>
            </div>
        </div>
        <div class="metric-card customers">
            <div class="metric-icon">üë•</div>
            <div class="metric-content">
                <h3>{{analytics.uniqueCustomers}}</h3>
                <p>Unique Customers</p>
                <span class="metric-change positive">+15% from last month</span>
            </div>
        </div>
    </div>

    <!-- Charts Section -->
    <div class="charts-container">
        <div class="chart-card">
            <div class="chart-header">
                <h3>Revenue Trend</h3>
                <div class="chart-filters">
                    <button class="filter-btn active" data-period="7d">7 Days</button>
                    <button class="filter-btn" data-period="30d">30 Days</button>
                    <button class="filter-btn" data-period="90d">90 Days</button>
                </div>
            </div>
            <div class="chart-container">
                <canvas id="revenueChart" width="400" height="200"></canvas>
            </div>
        </div>

        <div class="chart-card">
            <div class="chart-header">
                <h3>Order Status Distribution</h3>
            </div>
            <div class="chart-container">
                <canvas id="orderStatusChart" width="400" height="200"></canvas>
            </div>
        </div>
    </div>

    <!-- Performance Tables -->
    <div class="tables-container">
        <div class="table-card">
            <h3>Top Selling Items</h3>
            <div class="table-wrapper">
                <table class="analytics-table">
                    <thead>
                        <tr>
                            <th>Item</th>
                            <th>Orders</th>
                            <th>Revenue</th>
                            <th>Rating</th>
                        </tr>
                    </thead>
                    <tbody>
                        {{#each analytics.topItems}}
                        <tr>
                            <td>
                                <div class="item-info">
                                    <strong>{{this.name}}</strong>
                                    <small>{{this.category}}</small>
                                </div>
                            </td>
                            <td>{{this.orderCount}}</td>
                            <td>‚Çπ{{this.revenue}}</td>
                            <td>
                                <span class="rating-badge">{{this.rating}} ‚≠ê</span>
                            </td>
                        </tr>
                        {{else}}
                        <tr>
                            <td colspan="4" class="no-data">No data available</td>
                        </tr>
                        {{/each}}
                    </tbody>
                </table>
            </div>
        </div>

        <div class="table-card">
            <h3>Recent Customer Reviews</h3>
            <div class="reviews-list">
                {{#each analytics.recentReviews}}
                <div class="review-item">
                    <div class="review-header">
                        <span class="customer-name">{{this.customerName}}</span>
                        <span class="review-rating">{{this.rating}} ‚≠ê</span>
                        <span class="review-date">{{formatDate this.date}}</span>
                    </div>
                    <p class="review-text">{{this.comment}}</p>
                    <span class="review-item-name">{{this.itemName}}</span>
                </div>
                {{else}}
                <div class="no-reviews">
                    <p>No reviews yet. Great reviews help attract more customers!</p>
                </div>
                {{/each}}
            </div>
        </div>
    </div>

    <!-- Insights Section -->
    <div class="insights-section">
        <h3>Business Insights</h3>
        <div class="insights-grid">
            <div class="insight-card">
                <div class="insight-icon">üìà</div>
                <div class="insight-content">
                    <h4>Peak Hours</h4>
                    <p>Most orders come between 12 PM - 2 PM and 7 PM - 9 PM</p>
                    <span class="insight-action">Consider special offers during off-peak hours</span>
                </div>
            </div>
            <div class="insight-card">
                <div class="insight-icon">üçï</div>
                <div class="insight-content">
                    <h4>Popular Items</h4>
                    <p>{{analytics.topItems.[0].name}} is your best seller with {{analytics.topItems.[0].orderCount}}
                        orders</p>
                    <span class="insight-action">Promote similar items to boost sales</span>
                </div>
            </div>
            <div class="insight-card">
                <div class="insight-icon">‚ö°</div>
                <div class="insight-content">
                    <h4>Response Time</h4>
                    <p>Your average order acceptance time is 3.5 minutes</p>
                    <span class="insight-action">Faster responses lead to better ratings</span>
                </div>
            </div>
            <div class="insight-card">
                <div class="insight-icon">üí°</div>
                <div class="insight-content">
                    <h4>Growth Opportunity</h4>
                    <p>Add more vegetarian options - 60% of customers prefer veg items</p>
                    <span class="insight-action">Expand your vegetarian menu</span>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .vendor-analytics-page {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
    }

    .page-header {
        background: white;
        padding: 24px;
        border-radius: 16px;
        box-shadow: 0 2px 12px rgba(0, 0, 0, 0.05);
        margin-bottom: 24px;
        text-align: center;
    }

    .page-header h1 {
        font-size: 28px;
        font-weight: 700;
        color: #1a202c;
        margin-bottom: 8px;
    }

    .page-header p {
        color: #4a5568;
        margin-bottom: 16px;
    }

    .back-btn {
        display: inline-block;
        background: #667eea;
        color: white;
        padding: 8px 16px;
        border-radius: 8px;
        text-decoration: none;
        font-weight: 500;
        transition: all 0.3s ease;
    }

    .back-btn:hover {
        background: #5a67d8;
        transform: translateY(-1px);
    }

    .metrics-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-bottom: 32px;
    }

    .metric-card {
        background: white;
        padding: 24px;
        border-radius: 16px;
        box-shadow: 0 2px 12px rgba(0, 0, 0, 0.05);
        display: flex;
        align-items: center;
        gap: 16px;
        position: relative;
        overflow: hidden;
    }

    .metric-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
    }

    .metric-card.revenue::before {
        background: linear-gradient(90deg, #10b981, #059669);
    }

    .metric-card.orders::before {
        background: linear-gradient(90deg, #3b82f6, #2563eb);
    }

    .metric-card.rating::before {
        background: linear-gradient(90deg, #f59e0b, #d97706);
    }

    .metric-card.customers::before {
        background: linear-gradient(90deg, #8b5cf6, #7c3aed);
    }

    .metric-icon {
        font-size: 32px;
        width: 60px;
        height: 60px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: #f7fafc;
        border-radius: 12px;
    }

    .metric-content h3 {
        font-size: 24px;
        font-weight: 700;
        color: #1a202c;
        margin-bottom: 4px;
    }

    .metric-content p {
        color: #4a5568;
        font-size: 14px;
        margin-bottom: 4px;
    }

    .metric-change {
        font-size: 12px;
        font-weight: 600;
        padding: 2px 6px;
        border-radius: 4px;
    }

    .metric-change.positive {
        background: #d1fae5;
        color: #059669;
    }

    .metric-change.negative {
        background: #fee2e2;
        color: #dc2626;
    }

    .metric-change.neutral {
        background: #f3f4f6;
        color: #6b7280;
    }

    .charts-container {
        display: grid;
        grid-template-columns: 2fr 1fr;
        gap: 24px;
        margin-bottom: 32px;
    }

    .chart-card {
        background: white;
        padding: 24px;
        border-radius: 16px;
        box-shadow: 0 2px 12px rgba(0, 0, 0, 0.05);
    }

    .chart-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
    }

    .chart-header h3 {
        font-size: 18px;
        font-weight: 700;
        color: #1a202c;
    }

    .chart-filters {
        display: flex;
        gap: 8px;
    }

    .filter-btn {
        padding: 6px 12px;
        border: 1px solid #e2e8f0;
        background: white;
        border-radius: 6px;
        cursor: pointer;
        font-size: 12px;
        transition: all 0.3s ease;
    }

    .filter-btn:hover,
    .filter-btn.active {
        background: #667eea;
        color: white;
        border-color: #667eea;
    }

    .chart-container {
        height: 300px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: #f7fafc;
        border-radius: 8px;
        color: #4a5568;
    }

    .tables-container {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 24px;
        margin-bottom: 32px;
    }

    .table-card {
        background: white;
        padding: 24px;
        border-radius: 16px;
        box-shadow: 0 2px 12px rgba(0, 0, 0, 0.05);
    }

    .table-card h3 {
        font-size: 18px;
        font-weight: 700;
        color: #1a202c;
        margin-bottom: 16px;
    }

    .table-wrapper {
        overflow-x: auto;
    }

    .analytics-table {
        width: 100%;
        border-collapse: collapse;
    }

    .analytics-table th,
    .analytics-table td {
        padding: 12px 8px;
        text-align: left;
        border-bottom: 1px solid #e2e8f0;
    }

    .analytics-table th {
        background: #f7fafc;
        font-weight: 600;
        color: #4a5568;
        font-size: 12px;
        text-transform: uppercase;
    }

    .item-info strong {
        display: block;
        color: #1a202c;
        font-size: 14px;
    }

    .item-info small {
        color: #718096;
        font-size: 12px;
    }

    .rating-badge {
        background: #fef3c7;
        color: #d97706;
        padding: 2px 6px;
        border-radius: 4px;
        font-size: 12px;
        font-weight: 600;
    }

    .no-data {
        text-align: center;
        color: #718096;
        font-style: italic;
        padding: 20px;
    }

    .reviews-list {
        max-height: 300px;
        overflow-y: auto;
    }

    .review-item {
        padding: 16px 0;
        border-bottom: 1px solid #e2e8f0;
    }

    .review-item:last-child {
        border-bottom: none;
    }

    .review-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 8px;
        flex-wrap: wrap;
        gap: 8px;
    }

    .customer-name {
        font-weight: 600;
        color: #1a202c;
    }

    .review-rating {
        background: #fef3c7;
        color: #d97706;
        padding: 2px 6px;
        border-radius: 4px;
        font-size: 12px;
        font-weight: 600;
    }

    .review-date {
        color: #718096;
        font-size: 12px;
    }

    .review-text {
        color: #4a5568;
        font-size: 14px;
        margin-bottom: 4px;
        line-height: 1.4;
    }

    .review-item-name {
        color: #667eea;
        font-size: 12px;
        font-weight: 500;
    }

    .no-reviews {
        text-align: center;
        padding: 40px 20px;
        color: #718096;
    }

    .insights-section {
        background: white;
        padding: 24px;
        border-radius: 16px;
        box-shadow: 0 2px 12px rgba(0, 0, 0, 0.05);
    }

    .insights-section h3 {
        font-size: 20px;
        font-weight: 700;
        color: #1a202c;
        margin-bottom: 20px;
    }

    .insights-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 16px;
    }

    .insight-card {
        background: #f7fafc;
        padding: 20px;
        border-radius: 12px;
        border-left: 4px solid #667eea;
        transition: transform 0.2s ease;
    }

    .insight-card:hover {
        transform: translateY(-2px);
    }

    .insight-icon {
        font-size: 24px;
        margin-bottom: 12px;
    }

    .insight-content h4 {
        font-size: 16px;
        font-weight: 700;
        color: #1a202c;
        margin-bottom: 8px;
    }

    .insight-content p {
        color: #4a5568;
        font-size: 14px;
        margin-bottom: 8px;
        line-height: 1.4;
    }

    .insight-action {
        color: #667eea;
        font-size: 12px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    @media (max-width: 768px) {
        .vendor-analytics-page {
            padding: 12px;
        }

        .metrics-grid {
            grid-template-columns: repeat(2, 1fr);
        }

        .charts-container,
        .tables-container {
            grid-template-columns: 1fr;
        }

        .insights-grid {
            grid-template-columns: 1fr;
        }

        .review-header {
            flex-direction: column;
            align-items: flex-start;
        }
    }
</style>

<script>
    // Sample chart data - in a real app, this would come from the server
    const revenueData = {
        '7d': [120, 150, 180, 200, 175, 220, 250],
        '30d': [1200, 1500, 1800, 2000, 1750, 2200, 2500],
        '90d': [3600, 4500, 5400, 6000, 5250, 6600, 7500]
    };

    const orderStatusData = {
        labels: ['Delivered', 'Preparing', 'Ready', 'Cancelled'],
        data: [65, 20, 10, 5],
        colors: ['#10b981', '#f59e0b', '#3b82f6', '#ef4444']
    };

    // Chart filter functionality
    document.querySelectorAll('.filter-btn').forEach(btn => {
        btn.addEventListener('click', function () {
            document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
            this.classList.add('active');

            const period = this.dataset.period;
            updateRevenueChart(period);
        });
    });

    function updateRevenueChart(period) {
        console.log(`Updating revenue chart for period: ${period}`);
        // In a real app, this would update the actual chart
        // For now, just log the action
    }

    // Initialize charts when page loads
    document.addEventListener('DOMContentLoaded', function () {
        initializeCharts();
    });

    function initializeCharts() {
        // Revenue Chart placeholder
        const revenueCanvas = document.getElementById('revenueChart');
        const revenueCtx = revenueCanvas.getContext('2d');
        revenueCtx.fillStyle = '#667eea';
        revenueCtx.fillRect(0, 0, revenueCanvas.width, revenueCanvas.height);
        revenueCtx.fillStyle = 'white';
        revenueCtx.font = '16px Arial';
        revenueCtx.textAlign = 'center';
        revenueCtx.fillText('Revenue Chart', revenueCanvas.width / 2, revenueCanvas.height / 2);
        revenueCtx.fillText('(Chart.js integration needed)', revenueCanvas.width / 2, revenueCanvas.height / 2 + 25);

        // Order Status Chart placeholder
        const statusCanvas = document.getElementById('orderStatusChart');
        const statusCtx = statusCanvas.getContext('2d');
        statusCtx.fillStyle = '#10b981';
        statusCtx.fillRect(0, 0, statusCanvas.width, statusCanvas.height);
        statusCtx.fillStyle = 'white';
        statusCtx.font = '16px Arial';
        statusCtx.textAlign = 'center';
        statusCtx.fillText('Order Status Chart', statusCanvas.width / 2, statusCanvas.height / 2);
        statusCtx.fillText('(Chart.js integration needed)', statusCanvas.width / 2, statusCanvas.height / 2 + 25);
    }

    // Export functionality
    function exportAnalytics() {
        alert('Analytics export functionality would be implemented here');
    }

    // Print analytics report
    function printReport() {
        window.print();
    }

    // Refresh data
    function refreshData() {
        window.location.reload();
    }

    // Show help tooltip
    function showHelp(metric) {
        const helpTexts = {
            revenue: 'Total amount earned from completed orders',
            orders: 'Number of orders received and completed',
            rating: 'Average customer rating based on reviews',
            customers: 'Number of unique customers who placed orders'
        };

        alert(helpTexts[metric] || 'Help information not available');
    }
</script>